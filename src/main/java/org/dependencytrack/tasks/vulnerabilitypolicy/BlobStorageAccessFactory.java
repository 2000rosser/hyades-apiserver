package org.dependencytrack.tasks.vulnerabilitypolicy;

import alpine.Config;
import org.dependencytrack.common.ConfigKey;

public class BlobStorageAccessFactory {

    public static BlobStorageAccessHandler createStorageHandler() {
         if (Config.getInstance().getProperty(ConfigKey.VULNERABILITY_POLICY_FETCH_SOURCE_NAME).equalsIgnoreCase("NGINX")) {
            return new NginxStorageHandler();
        } else if(Config.getInstance().getProperty(ConfigKey.VULNERABILITY_POLICY_FETCH_SOURCE_NAME).equalsIgnoreCase("s3")){
             S3Client s3Client = new S3Client();
             return new S3StorageHandler(s3Client);
         }
        return new GenericStorageHandler();
    }
}
