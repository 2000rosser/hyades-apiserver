package org.dependencytrack.model;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.datatype.jsonorg.JsonOrgModule;
import org.dependencytrack.model.vulnerabilitypolicy.VulnerabilityPolicyAnalysis;
import org.json.JSONObject;
import javax.jdo.AttributeConverter;

public class VulnerabilityPolicyAnalysisAttributeConverter implements AttributeConverter<VulnerabilityPolicyAnalysis, JSONObject> {
    private static final ObjectMapper MAPPER = new ObjectMapper().registerModule(new JsonOrgModule());
    @Override
    public JSONObject convertToDatastore(VulnerabilityPolicyAnalysis vulnerabilityPolicyAnalysis) {
        return MAPPER.convertValue(vulnerabilityPolicyAnalysis, JSONObject.class);
    }

    @Override
    public VulnerabilityPolicyAnalysis convertToAttribute(JSONObject object) {
        return MAPPER.convertValue(object, VulnerabilityPolicyAnalysis.class);
    }

}
