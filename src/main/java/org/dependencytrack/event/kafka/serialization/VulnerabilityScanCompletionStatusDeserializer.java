package org.dependencytrack.event.kafka.serialization;

import org.apache.kafka.common.serialization.Deserializer;
import org.dependencytrack.event.kafka.dto.VulnerabilityScanCompletionStatus;

import java.nio.charset.StandardCharsets;
import java.util.Optional;

public class VulnerabilityScanCompletionStatusDeserializer implements Deserializer<VulnerabilityScanCompletionStatus> {

    @Override
    public VulnerabilityScanCompletionStatus deserialize(final String topic, final byte[] data) {
        return Optional.ofNullable(data)
                .map(bytes -> new String(bytes, StandardCharsets.UTF_8))
                .map(VulnerabilityScanCompletionStatus::valueOf)
                .orElse(null);
    }

}
