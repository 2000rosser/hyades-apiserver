package org.dependencytrack.event.kafka.serialization;

import org.apache.kafka.common.serialization.Serializer;
import org.dependencytrack.event.kafka.dto.VulnerabilityScanCompletionStatus;

import java.nio.charset.StandardCharsets;
import java.util.Optional;

public class VulnerabilityScanCompletionStatusSerializer implements Serializer<VulnerabilityScanCompletionStatus> {

    @Override
    public byte[] serialize(final String topic, final VulnerabilityScanCompletionStatus data) {
        return Optional.ofNullable(data)
                .map(VulnerabilityScanCompletionStatus::name)
                .map(name -> name.getBytes(StandardCharsets.UTF_8))
                .orElse(null);
    }

}
